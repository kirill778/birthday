# Приложение "Дни рождения сотрудников"

Приложение для отслеживания дней рождения сотрудников с синхронизацией между разными устройствами, работающими на разных IP-адресах.

## Содержание

- [Возможности](#возможности)
- [Технологии](#технологии)
- [Требования](#требования)
- [Установка](#установка)
- [Запуск](#запуск)
- [Синхронизация](#синхронизация)
- [Руководство пользователя](#руководство-пользователя)
- [Устранение неполадок](#устранение-неполадок)
- [Разработка](#разработка)
- [Лицензия](#лицензия)

## Возможности

- Добавление, редактирование и удаление дней рождения сотрудников
- Отображение дней рождения на текущий месяц и следующий месяц
- Сортировка и фильтрация списка дней рождения
- Синхронизация данных между разными устройствами через центральный сервер
- Автоматическое переключение между локальным хранилищем и серверной синхронизацией
- Адаптивный дизайн под мобильные устройства и десктоп
- Визуальные индикаторы статуса синхронизации

## Технологии

### Frontend:
- React 18+
- Vite
- TailwindCSS
- Framer Motion (анимации)
- date-fns (работа с датами)
- React Icons

### Backend:
- Python 3.7+ (рекомендуется Python 3.10)
- Flask (веб-сервер)
- Flask-CORS (для обработки кросс-доменных запросов)

### Синхронизация:
- REST API
- localStorage (резервный вариант)
- Механизм периодической синхронизации (каждые 10 минут)

## Требования

- Node.js 14+ (рекомендуется Node.js 16+)
- Python 3.7+ (рекомендуется Python 3.10)
- npm или yarn
- Современный браузер с поддержкой ES6

## Установка

### 1. Клонирование репозитория

```bash
git clone [URL репозитория]
cd [папка проекта]
```

### 2. Установка зависимостей Frontend

```bash
npm install
```

или при использовании yarn:

```bash
yarn install
```

### 3. Установка зависимостей Backend

Рекомендуется использовать виртуальное окружение Python:

#### Windows:
```bash
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
```

#### Linux/Mac:
```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

Если файла requirements.txt нет, установите следующие пакеты:

```bash
pip install flask flask-cors
```

## Запуск

### Режим разработки

1. **Запуск Backend (сервер синхронизации)**

Откройте терминал в папке проекта и выполните:

```bash
python server.py
```

Сервер запустится на порту 5000. Вы увидите в консоли доступные IP-адреса для подключения.

2. **Запуск Frontend (интерфейс приложения)**

Откройте новый терминал в папке проекта и выполните:

```bash
npm run dev
```

или

```bash
yarn dev
```

3. **Доступ к приложению**

- Локально: http://localhost:5173/ (или другой порт, указанный Vite)
- По IP в локальной сети: http://[ваш IP]:5173/ (для доступа с других устройств)

### Production режим

1. **Сборка Frontend**

```bash
npm run build
```

или

```bash
yarn build
```

Это создаст оптимизированную версию приложения в папке `dist`.

2. **Запуск сервера**

```bash
python server.py
```

3. **Доступ к приложению**

После сборки и запуска сервера, приложение будет доступно по адресу:
- http://localhost:5000/
- http://[ваш IP]:5000/ (для доступа с других устройств)

## Синхронизация

Приложение поддерживает два режима синхронизации данных:

### 1. Локальная синхронизация (localStorage)

- Автоматически используется, если сервер недоступен
- Работает в пределах одного браузера через несколько вкладок
- Данные хранятся локально в localStorage браузера
- Использует механизм событий хранилища для обмена данными между вкладками
- **Ограничение:** не синхронизирует данные между разными устройствами или разными IP-адресами

### 2. Серверная синхронизация

- Активируется автоматически при доступности сервера
- Данные хранятся централизованно на сервере в файле `birthday_data.json`
- Периодическая синхронизация каждые 10 минут
- Поддерживает мгновенное сохранение при добавлении/изменении данных
- Автоматически разрешает конфликты синхронизации (преимущество имеют более новые данные)
- Позволяет работать с приложением с разных устройств в сети

Приложение автоматически определяет доступность сервера и выбирает соответствующий режим синхронизации.

## Руководство пользователя

### Добавление дня рождения

1. Нажмите кнопку "Добавить" в верхней части страницы
2. Заполните форму:
   - ФИО сотрудника (обязательно)
   - Дата рождения (обязательно)
   - Заметки (необязательно) - можно добавить информацию о предпочтениях, идеи подарков и т.д.
3. Нажмите "Сохранить"
4. При успешном сохранении форма закроется, и новая запись появится в списке

### Просмотр списка дней рождения

- **Текущий месяц** - отображаются дни рождения в текущем месяце
- **Следующий месяц** - дни рождения в следующем месяце
- **Все дни рождения** - полный список всех добавленных дней рождения

Список автоматически сортируется по дате (не по году, а по дню и месяцу).

### Редактирование и удаление записей

1. Наведите курсор на запись в списке
2. Используйте появившиеся кнопки:
   - Редактировать - открывает форму редактирования
   - Удалить - удаляет запись (с подтверждением)

### Статус синхронизации

В нижней части формы добавления показывается статус синхронизации:
- "Синхронизация с сервером активна" - данные синхронизируются через сервер
- Отсутствие сообщения означает, что используется локальная синхронизация

## Устранение неполадок

### Данные не синхронизируются между устройствами

1. **Проверьте запущен ли сервер**
   - Запустите сервер командой `python server.py`
   - Убедитесь, что в консоли нет сообщений об ошибках

2. **Проверьте доступность сервера**
   - Откройте в браузере http://localhost:5000/api/sync/ping
   - Должен отобразиться JSON-ответ со статусом `ok`

3. **Проверьте сетевые настройки**
   - Убедитесь, что устройства находятся в одной сети
   - Проверьте, не блокирует ли брандмауэр порт 5000
   - Попробуйте получить доступ к серверу с другого устройства по его IP

4. **Проверьте консоль браузера**
   - Откройте инструменты разработчика (F12 или Ctrl+Shift+I)
   - Перейдите на вкладку "Console"
   - Проверьте наличие ошибок связанных с синхронизацией

5. **Перезагрузите страницу**
   - Полное обновление страницы (Ctrl+F5) может помочь установить новое соединение с сервером

6. **Проверьте файл данных на сервере**
   - Убедитесь, что файл `birthday_data.json` существует в папке с сервером и не поврежден

### Сервер не запускается

1. **Проверьте установлены ли все зависимости**
   ```bash
   pip install flask flask-cors
   ```

2. **Проверьте доступность порта 5000**
   - Порт 5000 может быть занят другим приложением
   - Измените порт в файле `server.py` (замените `port=5000` на другой номер порта)

3. **Проверьте версию Python**
   - Flask может требовать определенную версию Python
   - Рекомендуется Python 3.10 или новее

### Приложение не отображается или работает некорректно

1. **Проверьте совместимость браузера**
   - Убедитесь, что используете современный браузер
   - Попробуйте открыть в другом браузере (Chrome, Firefox, Edge)

2. **Очистите кэш браузера**
   - Иногда проблемы вызваны устаревшим кэшем
   - Для полной очистки нажмите Ctrl+F5 или Ctrl+Shift+R

3. **Проверьте ошибки JavaScript**
   - Откройте консоль браузера и проверьте наличие ошибок

## Разработка

### Структура проекта

- `src/` - исходный код Frontend (React)
  - `components/` - React-компоненты
  - `context/` - контекст React для хранения состояния
  - `utils/` - утилиты, включая сервис синхронизации
- `public/` - статические файлы
- `server.py` - сервер синхронизации (Python Flask)
- `birthday_data.json` - файл для хранения данных на сервере
- `vite.config.js` - конфигурация Vite

### Параметры синхронизации

Периодичность синхронизации данных с сервером установлена на 10 минут. Это значение можно изменить в файле `src/utils/syncService.js`:

```javascript
// Находим строку:
}, 600000); // Проверка каждые 10 минут
```

Измените значение 600000 (10 минут в миллисекундах) на нужное вам значение.

## Лицензия

[MIT](LICENSE) 